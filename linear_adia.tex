\subsection{Thin-disk approximation}\label{analytic_relax}
Our final approximation apply to thin disks for 
which $\epsilon\ll 1$. Then we may write $\rho/\rho_0\simeq
\exp{(-\zhat^2/2)}$. The governing equation,
Eq. \ref{vertiso_gov_nondim}, is then   
\begin{align}
  \delta v_z^{\prime\prime} - z A\delta v_z^\prime +
  (B - C\zhat^2)\delta v_z = 0,\label{nearly_iso_explicit}
\end{align}
with
\begin{align}
  &A \equiv 1 + \ii \epsilon q \hat{k},\\
  &B \equiv \hat{\sigma}^2\left(\chi + \hat{k}^2\right) -
  \left(\chi + \ii \epsilon q \hat{k}\right),\\
  &C \equiv \left(1-\chi\right)\left(\hat{k}^2 - \ii
    \epsilon q\hat{k}\right), 
\end{align}
and $\chi =
\left(1-\ii\hat{\sigma}\beta\right)/\left(1-\ii\hat{\sigma}\beta\gamma\right)
$ in terms of dimensionless variables. 

We remark that Eq. \ref{nearly_iso_explicit} is in the same 
form as Eq. 41 in \cite{lubow93}, which describe adiabatic axisymmetric waves in
a vertically isothermal disk without vertical shear. The two equations
become identical after  setting $q=0$ (no vertical shear) and
$\chi=1/\gamma$ (adiabatic flow) in our Eq. \ref{nearly_iso_explicit},
and making the low-frequency, Keplerian approximation in
\citeauthor{lubow93} after a change of variables.    


\subsection{Isothermal perturbations}\label{iso_pert}
Isothermal perturbations correspond to $\beta = 0$ or $\gamma=1$ so 
that $\chi = 1$. This case has been investigated by \cite{nelson13},
\cite{mcnally14} and \cite{barker15}.  

In Appendix \ref{iso_discuss}, we collect some useful results for
isothermal  perturbations. This includes a necessary condition for
instability (there must be vertical shear) and an upper bound to the
instability growth rate (it is limited by the maximum vertical shear
rate in the disk). We also develop solutions in the thin disk
limit. The methods used in Appendix \ref{iso_discuss} and results obtained
therein motivates the solution procedure employed in the following
sections, and are provided for ease of reference. We refer the reader
to \cite{barker15} for a more detailed treatment of isothermal 
perturbations. %which also account for more general boundary
               %conditions than that considered below 

\subsection{The effect of introducing a small but finite
  thermal relaxation time}\label{relax_pert}
We are interested in finite thermal relaxation
timescales $\beta > 0$, but it is instructive to
first ask  the more analytically tractable question: how 
do the eigenfrequencies and eigenfunctions change when we change
$\beta$ from zero to a small but finite value? For 
sufficiently small $\beta$ we expect the solution to only differ
slightly from a case with $\beta\equiv 0$. We thus perturb a solution
for $\beta=0$ to see the effect of thermal relaxation.  

For definiteness, let us consider the simple solution 
\begin{align}
  \beta\equiv 0, \quad \delta v_z = 1,\quad \hat{\sigma}^2 = \frac{1 +
  \ii\epsilon q \hat{k}}{1+\hat{k}^2}, \label{pert_basic} 
\end{align}
which solves Eq. \ref{nearly_iso_explicit} since $\delta
v_z=$constant and $\chi=1$ so that $B=C=0$. 
This is the lowest order VSI mode, the `fundamental corrugation mode',
where the vertical velocity is constant throughout the disk
column. Hereafter we shall simply refer to them as the fundamental
mode. 

The fundamental mode has been observed to dominate numerical simulations
\citep{nelson13,stoll14}, and are the ones we find to typically 
dominate in numerical calculations with increasing $\beta$
(\S\ref{therm_relax_eff}) for moderately large    
values of $\khat$, as well as in protoplanetary disks 
with a realistic estimate for thermal timescales
(\S\ref{application}). We will see later that consideration of low
order modes in fact provides a useful way to charactertize the effect
of increasing the thermal timescale on the VSI. 

We linearize Eq. \ref{nearly_iso_explicit} about the above
solution for $\beta\equiv0$ and write 
\begin{align}\label{nearly_iso_pert}
  \beta \to 0 + \delta\beta,\, \delta v_z\to \delta v_z+\delta
  v_{z1},\,\hat{\sigma} \to \hat{\sigma} + \delta\hat{\sigma}, 
\end{align}
which implies 
\begin{align}
  \chi \to 1 + \delta\chi = 1 + \ii \hat{\sigma}\left(\gamma-1\right)\delta\beta,
\end{align}
with $\delta v_z$ and $\hat{\sigma}$ given by Eq. \ref{pert_basic}. We
may then seek  
\begin{align}
  \delta v_{z1} = a \zhat^2 + b,
\end{align}
where $a$, $b$ are constants. 

We insert Eq. \ref{nearly_iso_pert} into
Eq. \ref{nearly_iso_explicit}, keeping only first order terms, and
solve for $\delta\hat{\sigma}$ using the above expressions for $\delta\chi$
and $\hat{\sigma}$. We find imaginary part of $\delta\hat{\sigma}$
is 
% yield the requirements, after
% balancing constants and coefficients of $\zhat^2$, 
% \begin{align}
%   0 &= 2a + 2\hat{\sigma}\left(1+\khat^2\right)\delta\hat{\sigma} +
%   \left(\hat{\sigma}^2 -1\right)\delta\chi, \\
%   0&= 2a\left(1+\ii\epsilon q \khat\right) - \left(\khat^2 - \ii\epsilon
%     q \khat\right)\delta\chi.
% \end{align}
% This gives 
% \begin{align}\label{nearly_iso_dsig}
%   \delta \hat{\sigma} =
%   -\frac{\ii\left(\gamma-1\right)\hat{k}^2\left(\ii\epsilon
%       q - \hat{k}\right)^2}{2\left(1+\ii\epsilon q \hat{k}\right)\left(1+\hat{k}^2\right)^2}\delta\beta.
% \end{align}
% The imaginary part of Eq. \ref{nearly_iso_dsig} is
\begin{align}
  \delta\hat{\nu} =
  -\frac{\left(\gamma-1\right)\hat{k}^2 \left(\hat{k}^2 -
      2\epsilon^2q^2\hat{k}^2 - \epsilon^2q^2\right)}{2\left(1+\epsilon^2 q^2
      \hat{k}^2\right)\left(1+\hat{k}^2\right)^2}\delta\beta.  
\end{align}
Since $\epsilon \ll 1$, introducing finite cooling $\delta\beta>0$
implies $\delta\hat{\nu} < 0$, i.e. stabilization, since $\gamma>1$. 
% Interestingly, for both
% $\hat{k}\to0$ and $\hat{k}\to\infty$ we find $\delta\hat{\nu}\to0$, so
% stabilization by small finite cooling is ineffective at very large or
% very small scales. 

A finite thermal relaxation time allow buoyancy
forces to stabilize vertical motions in sub-adiabatically stratified
disks. The $\zhat^2$ dependence in $\delta v_{z1}$ makes  
sense because it becomes significant at large $|\zhat|$, i.e. away from
the midplane where the effect of buoyancy first appears as $\beta$ is
increased from zero (since $N_z^2\propto z^2$ for a thin disk, see
Eq. \ref{nzsq_def}).   

\subsection{Explicit solutions and dispersion relation}\label{disp_relax}
We now solve Eq. \ref{nearly_iso_explicit} explicitly. We first write  
\begin{align}
  \delta v_z(\zhat) =
  g(\zhat)\exp\left(\frac{\alpha\zhat^2}{2}\right), \label{adia_ansatz}
\end{align}
where $\alpha$ is a constant to be chosen for convenience. Inserting
Eq. \ref{adia_ansatz} into Eq. \ref{nearly_iso_explicit} gives
\begin{align}
  0 = g^{\prime\prime} - \hat{z}\left(A - 2\alpha\right)g^\prime + \left(B +
    \alpha\right)g
  +\left(\alpha^2 - \alpha A - C\right)\zhat^2 g.
\end{align}
We choose $\alpha$ to make the coefficient of $\zhat^2g$
vanish, and impose the vertical kinetic energy density
$\rho|\delta v_z|^2\propto |g|^2 \exp{\left(\real\alpha -
    1/2\right)\zhat^2}$ to remain finite as $|\zhat|\to\infty$. 
Then assuming $g(\zhat)$ is a polynomial, we require  
\begin{align}
  \real\alpha < \frac{1}{2}, 
\end{align}
which amounts to choosing 
\begin{align}
  \alpha = \frac{1}{2}\left(A - \sqrt{A^2 + 4C}\right).  
\end{align} 


Eq. \ref{nearly_iso_explicit} becomes 
\begin{align}
  0 = g^{\prime\prime} - \hat{z}\left(A - 2\alpha\right)g^\prime +
  \left(B + \alpha\right)g.
\end{align}
We seek polynomial solutions 
\begin{align}
  g(\zhat) = \sum_{m=0}^M b_m \zhat^m,
\end{align}
which requires
\begin{align}
  B(\hat{\sigma}) + \alpha(\hat{\sigma}) =
  M\left[A-2\alpha(\hat{\sigma})\right].\label{adia_disp0} 
\end{align}
For ease of analysis, we re-arrange Eq. \ref{adia_disp0} and square it
to obtain a polynomial in $\hat{\sigma}$,  
\begin{align}
  0 = \sum_{l=0}^{6}c_l\hat{\sigma}^l,\label{relax_disp}
\end{align}
where the coefficients $c_l$ are given in Appendix \ref{relax_coeff}.
The dispersion relation $\hat{\sigma}=\hat{\sigma}(\khat)$ is
complicated and generally requires a numerical solution. However,
simple results may be obtained in limiting cases which we consider
below.  

\subsection{Upper limit on the thermal relaxation timescale for the
  VSI}\label{iso_vsi_beta_crit}
Here we estimate the maximum thermal relaxation timescale 
$\beta$ that allows the VSI.  
Our starting point is Eq. \ref{relax_cond1}---\ref{relax_cond2} which
approximates the dispersion relation Eq. \ref{relax_disp} assuming marginal
stability and $\khat^2\gg 1$. We consider $M=0$ (the 
fundamental mode) or  $M=O(1)$ and low frequency $|\hat{\omega}|\ll
1$ such that $|\hat{\omega}\khat|$ is $O(1)$. We 
also assume $|q|$ and $\beta$ are $O(1)$ or smaller. For a thin disk
($\epsilon \ll 1$) we have 
\begin{align}
 0 = &M(M+1)\left(1-\epsilon^2q^2\khat^2\right) \notag\\ 
 &+ \left[1 +
    \gamma\beta^2\left(1-\gamma\right)(1+2M)^2\right]\left(\hat{\omega}\khat\right)^2
   -  \left(\hat{\omega}\khat\right)^4,\label{relax_cond_simp1}\\
   0= &2M(M+1) + \frac{\beta}{\epsilon q} (1-\gamma)(1+2M)^2
   \left(\hat{\omega}\khat\right) + \left(\hat{\omega}\khat\right)^2. \label{relax_cond_simp2}
\end{align}
(We explain this in Appendix \ref{disp_neut_limit}.)

Eq. \ref{relax_cond_simp1}---\ref{relax_cond_simp2} is a pair of
simultaneous equations for $\hat{\omega}$ and $\beta$ for marginal
stability. (It is important to note that marginal stability is an
assumption.) If $\beta\ll 1$ and the disk is sufficiently thin so that  
$|\epsilon q \khat |^2\lesssim 1$, 
then an approximate solution to Eq. \ref{relax_cond_simp1} is 
\begin{align}
  \left(\hat{\omega}\khat\right)^2 \simeq (M+1)\left(1 -
    \frac{M|\epsilon q \khat|^2}{2M+1}\right).  \label{marg_freq_approx}
\end{align}
Note that for $q=0$, Eq. \ref{marg_freq_approx} reduces to 
the dispersion relation for low-frequency inertial waves in vertically
isothermal disks without vertical shear (see Appendix
\ref{stable_novshear}). Inserting Eq. \ref{marg_freq_approx} into
Eq. \ref{relax_cond_simp2}, we obtain 
\begin{align}\label{bcrit_gen}
  \beta &= \frac{\epsilon|q|}{(\gamma - 1)}
  \frac{\sqrt{1+M}}{(1+2M)}\left[1 + \frac{M(2M-1)|\epsilon q
      \khat|^2}{2(2M+1)^2}\right].
%  &\lesssim \beta_\mathrm{crit}\notag
\end{align}
Since $|\epsilon q \khat|^2\lesssim 1$ by assumption, we have  
\begin{align}\label{iso_vsi_cond}
  \beta\leq \beta_\mathrm{crit}  \equiv
  \frac{\epsilon|q|}{\gamma-1}, 
\end{align}
where $\beta_\mathrm{crit}$ is the critical thermal timescale for
the fundamental mode ($M=0$). 
We comment the expression for $\beta_\mathrm{crit}$ may in fact be
obtained without assuming it is much less than unity from the onset or
$|\epsilon q\khat|\lesssim 1$. % This is because for $M=0$, 
% Eq. \ref{relax_cond_simp1} --- \ref{relax_cond_simp2} simplify 
We will  
confirm $\beta_\mathrm{crit}$ numerically in \S\ref{bcrit_num_test}. 

Eq. \ref{iso_vsi_cond} suggests that as the thermal timescale $\beta$
is increased from zero, higher order modes with $M>0$
will be stabilized before the fundamental mode. We indeed observe this
trend in numerical calculations (\S\ref{therm_relax_eff}), despite
adopting somewhat restrictive assumptions for $M>0$ in order to arrive
at the simple expression Eq. \ref{bcrit_gen}. 

Rapid thermal relaxation is required to overcome a stabilizing
vertical entropy gradient \citep{goldreich67,urpin98,urpin03}. 
Eq. \ref{iso_vsi_cond} quantifies this requirement for vertically
global disturbances (which have small $M$).  We can interpret 
$\beta_\mathrm{crit}$ as the thermal timescale below which 
perturbations are effectively isothermal and the VSI operates. We see
that in a thin disk, a very short thermal timescale is required
($\beta_\mathrm{crit}\ll 1$) because $\beta_\mathrm{crit}\propto
\epsilon$. Physically, this is because vertical shear is weak in a
thin disk, so even a small entropy gradient can significantly reduce
VSI growth rates.  





% Here we estimate the maximum thermal relaxation timescale
% $\beta$ that allows the fundamental VSI mode for $\khat\gg1$.   

% At marginal stability, the eigenfrequency $\hat{\sigma}=\hat{\omega}$
% is real. The dispersion relation for the fundamental mode is then
% \begin{align}\label{relax_disp_fund}
%   0 = \sum_{l=1}^{6}c_l\hat{\omega}^l \quad \text{for $M=\hat{\nu}=0$}.  
% \end{align} 
% Taking the real and imaginary parts of Eq. \ref{relax_disp_fund} and considering 
% $\khat\gg1$, we find
% \begin{align}
%   0 =& \left[1 + \gamma\beta^2\left(1-\gamma\right)\right] + 2\epsilon q
%   \gamma\beta (\hat{\omega}\khat) -  (\hat{\omega}\khat)^2 \notag\\
%   &+ \beta^2\gamma^2\hat{\omega}^2 (\hat{\omega}\khat)^2,\label{relax_cond1}\\
%   0=& \beta(1-\gamma)\khat^2 + \epsilon q \khat^2 (\hat{\omega}\khat)
%   - 2\beta (\hat{\omega}\khat)^2 - \epsilon q \gamma^2\beta^2 (\hat{\omega}\khat)^3 \notag\\
%     &+ 2\beta\gamma(\hat{\omega}\khat)^4.  
% \label{relax_cond2}
% \end{align}
% This is a pair of simultaneous equations for
% $\hat{\omega}$ and $\beta$. Now, low-frequency axisymmetric waves in
% the absence of vertical shear are stable and  satisfy
% $\hat{\omega}\propto \khat^{-1}$ (Appendix \ref
% {stable_novshear}, Eq. \ref{iso_disp_full}).  We are thus motivated to
% seek solutions to Eq. \ref{relax_cond1}---\ref{relax_cond2} with  
% % we wish to seek a criterion independent of k 
% % \begin{align}
% %   \khat \to \infty, \quad \hat{\omega}\to 0 ,\quad \hat{\omega} \khat\text{ finite}.
% %\end{align}
% \begin{align}
%   \khat \gg1, \quad |\hat{\omega}|\ll 1 ,\quad
%   |\hat{\omega}\khat|=O(1). 
% \end{align}
% Then
% \begin{align}
%   \hat{\omega}\khat = \frac{(\gamma-1)\beta}{\epsilon q}
% \end{align}
% from Eq. \ref{relax_cond2}, which implies, from Eq. \ref{relax_cond1}
% that
% \begin{align}\label{beta_crit0}
%   \beta = \frac{1}{(\gamma-1)}\left[\frac{1}{\left(\epsilon
%         q\right)^2} - \frac{\gamma}{(\gamma-1)}\right]^{-1/2} 
% \end{align}
% at marginal stability for perturbations with large $\khat$. 

% From our discussion in \S\ref{relax_pert}, which indicate introducing
% a finite thermal relaxation is stabilizing, we expect
% Eq. \ref{beta_crit0} is an upper limit. For a thin  
% disk $\epsilon\ll 1$, we thus infer 
% \begin{align}\label{iso_vsi_cond}
%   \beta \lesssim \frac{|\epsilon q|}{\gamma-1} \equiv
%   \beta_\mathrm{crit} 
% \end{align}
% is required for the fundamental VSI to operate. That is, when
% $\beta<\beta_\mathrm{crit}$, perturbations are  effectively isothermal. 
% We will confirm Eq. \ref{iso_vsi_cond} numerically in
% \S\ref{bcrit_num_test}. 